---
title: "US tariffs  effects on magnificent seven stocks"
execute: 
  echo: false
  warning: false
  message: false

---

```{r}
library(quantmod)     # For fetching financial data
library(tidyverse)    # For data manipulation and ggplot
library(gganimate)    # For creating animations
library(gifski)       # For rendering GIFs
library(scales)       # For formatting prices as dollars



```

```{r}
#| echo: false
#| message: false
#| warning: false
#| results: 'hide'

# Define the Magnificent 7 tickers
tickers <- c("AAPL", "MSFT", "AMZN", "GOOGL", "NVDA", "META", "TSLA")

# Downloaded Adjusted Closing Prices from Yahoo Finance
getSymbols(tickers, src = "yahoo", from = "2018-01-01", to = Sys.Date())

# Combined and reshaped the data to tidy format 
prices <- map(tickers, ~ Ad(get(.x))) %>%
  reduce(merge) %>%
  `colnames<-`(tickers) %>%
  fortify.zoo(name = "Date") %>%
  pivot_longer(-Date, names_to = "Stock", values_to = "Price")


```

```{r}
# Define all tariff events dates and their labels
events <- tibble(
  Date = as.Date(c("2018-03-22", "2018-07-06", "2018-09-24",
                   "2019-05-10", "2019-09-01", "2025-06-15")),
  Label = c("$50B Tariff", "First Tariff", "$200B Tariffs",
            "25% Increase", "Consumer Tariffs", "New Tariff"),
  y_end = c(800, 850, 900, 950, 1000, 1050)
)

#  all event dates match actual stock price trading days
available_dates <- unique(prices$Date)

# Replacing missing event dates with closest available dates
events <- events %>%
  mutate(Date = if_else(Date %in% available_dates, Date,
                        map_dbl(Date, ~ max(available_dates[available_dates <= .x])) %>% as.Date(origin = "1970-01-01")))


```

```{r}
# Joined each event date with each stock to annotate on the lines
inline_event_labels <- inner_join(prices, events, by = "Date") %>%
  mutate(Label = paste0(Label, "\n", dollar(Price)))

```
U.S. tariffs on China from 2018 to 2025 have significantly affected domestic capital markets. Tariff announcements hit supply chainâ€“dependent firms like Apple, Tesla, Amazon, and Nvidia the hardest. I gathered stock data using the "quantmod" package in R from Yahoo Finance, covering the Magnificent Seven tech stocks from 2018 to 2025..



## ðŸŽ¥ Stock Price Animation with U.S. Tariff Events
![](stocks_tariffs.gif)

**Discripption**
The animated graph shows the stock prices (in USD) of the Magnificent Seven from 2018 to 2025. Key U.S.â€“China tariff events are marked with red dashed lines. At the start of each tariff event, there is a noticeable drop in the prices of supply chainâ€“dependent stocks like Apple, Tesla, and Nvidia. A yellow box highlights Appleâ€™s stock price at the beginning of each event.

This is a raw data visualization that includes all major factors affecting these stocks. The exact impact of tariffs on each stock will be analyzed in the main project using regression and other statistical tools.











